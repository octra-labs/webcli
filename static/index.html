<!--
    This file is part of Octra Wallet (webcli).

    Octra Wallet is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 2 of the License, or
    (at your option) any later version.

    Octra Wallet is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with Octra Wallet.  If not, see <http://www.gnu.org/licenses/>.

    This program is released under the GPL with the additional exemption
    that compiling, linking, and/or using OpenSSL is allowed.
    You are free to remove this exemption from derived works.

    Copyright 2025-2026 Octra Labs
              2025-2026 David A.
              2025-2026 Alex T.
              2025-2026 Vadim S.
              2025-2026 Julia L.
-->

<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>octra_wallet</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<div id="modal-overlay" style="display:none">
  <div id="modal-box">
    <div id="modal-title">octra_wallet</div>
    <div id="modal-sub">no wallet found</div>
    <div id="modal-btns">
      <button class="action-btn" onclick="modalShowImport()">import</button>
      <button class="action-btn" onclick="modalCreate()">create new</button>
    </div>
    <div id="modal-import" style="display:none">
      <div class="form-row">
        <label>private key (base64)</label>
        <textarea id="modal-privkey" rows="3" placeholder="paste base64 private key..."></textarea>
      </div>
      <div class="action-row">
        <button class="action-btn" onclick="modalDoImport()">import</button>
        <button class="action-btn" style="background:#8C9DB6" onclick="modalBack()">back</button>
      </div>
    </div>
    <div id="modal-pin" style="display:none">
      <div class="form-row">
        <label>enter 6-digit PIN to unlock</label>
        <input type="password" id="modal-pin-input" maxlength="6" inputmode="numeric" placeholder="------" autocomplete="off">
      </div>
      <div class="action-row">
        <button class="action-btn" onclick="modalUnlock()">unlock</button>
      </div>
    </div>
    <div id="modal-pin-setup" style="display:none">
      <div class="form-row">
        <label>create a 6-digit PIN</label>
        <input type="password" id="modal-pin-new" maxlength="6" inputmode="numeric" placeholder="------" autocomplete="off">
      </div>
      <div class="form-row">
        <label>confirm PIN</label>
        <input type="password" id="modal-pin-confirm" maxlength="6" inputmode="numeric" placeholder="------" autocomplete="off">
      </div>
      <div class="action-row">
        <button class="action-btn" onclick="modalFinishSetup()">set PIN</button>
        <button class="action-btn" style="background:#8C9DB6" onclick="modalBackFromPin()">back</button>
      </div>
    </div>
    <div id="modal-result"></div>
  </div>
</div>

<div class="wrap">

<header>
  <div class="left">
    <div class="title">octra_wallet</div>
    <div class="subtitle" id="hdr-addr">loading...</div>
  </div>
  <div class="hdr-right-group">
    <div class="right" id="hdr-status">connecting...</div>
    <button class="right logout-btn" id="hdr-dev" onclick="switchView('dev')" style="display:none">dev tools</button>
    <button class="right logout-btn" id="hdr-logout" onclick="doLogout()" style="display:none">logout</button>
  </div>
</header>

<div class="nav-tabs">
  <a href="#" class="active" data-view="dashboard" onclick="switchView('dashboard');return false">dashboard</a>
  <a href="#" data-view="send" onclick="switchView('send');return false">send</a>
  <a href="#" data-view="encrypt" onclick="switchView('encrypt');return false">encryption</a>
  <a href="#" data-view="stealth" onclick="switchView('stealth');return false">stealth <span id="stealth-badge" class="badge" style="display:none"></span></a>
  <a href="#" data-view="tokens" onclick="switchView('tokens');return false">tokens</a>
  <a href="#" data-view="history" onclick="switchView('history');return false">history</a>
  <a href="#" data-view="keys" onclick="switchView('keys');return false">keys</a>
  <a href="#" data-view="settings" onclick="switchView('settings');return false">settings</a>
</div>

<div class="content-area">

  <div class="view active" id="view-dashboard">
    <div class="stats-row">
      <div class="stat-box"><div class="label">public balance</div><div class="value" id="st-balance">-</div></div>
      <div class="stat-box"><div class="label">encrypted balance</div><div class="value" id="st-enc-balance">-</div></div>
      <div class="stat-box"><div class="label">nonce</div><div class="value" id="st-nonce">-</div></div>
      <div class="stat-box"><div class="label">staging</div><div class="value" id="st-staging">-</div></div>
    </div>
    <div class="section">
      <div class="section-title">recent transactions</div>
      <div id="dash-txs"><div class="loading">loading...</div></div>
      <div id="dash-more"></div>
    </div>
  </div>

  <div class="view" id="view-send">
    <div class="balance-strip">
      <span class="bal-label">available:</span> <span id="send-bal" class="mono">-</span>
    </div>
    <div class="section-title">send oct</div>
    <div class="form-area">
      <div class="form-row">
        <label>recipient address</label>
        <input type="text" id="send-to" placeholder="oct...">
      </div>
      <div class="form-row">
        <label>amount (oct)</label>
        <input type="text" id="send-amount" placeholder="0.000000">
      </div>
      <div class="form-row">
        <label>message (optional)</label>
        <input type="text" id="send-msg" placeholder="">
      </div>
      <div class="form-row">
        <label>fee (ou) - recommended by default</label>
        <input type="text" id="send-fee" placeholder="...">
      </div>
      <div class="action-row">
        <button class="action-btn" onclick="doSend()">send</button>
      </div>
      <div id="send-result"></div>
    </div>
  </div>

  <div class="view" id="view-encrypt">
    <div class="balance-strip">
      <span class="bal-label">public balance:</span> <span id="enc-pub-bal" class="mono">-</span>
      <span class="bal-sep">|</span>
      <span class="bal-label">encrypted balance:</span> <span id="enc-enc-bal" class="mono">-</span>
    </div>
    <div class="form-split">
      <div class="form-panel">
        <div class="form-panel-title">encrypt</div>
        <div class="form-row">
          <label>amount to encrypt (oct)</label>
          <input type="text" id="enc-amount" placeholder="0.000000">
        </div>
        <div class="form-row">
          <label>fee (ou) - recommended by default</label>
          <input type="text" id="enc-fee" placeholder="...">
        </div>
        <div class="action-row">
          <button class="action-btn" onclick="doEncrypt()">encrypt</button>
        </div>
        <div id="enc-result"></div>
      </div>
      <div class="form-panel">
        <div class="form-panel-title">decrypt</div>
        <div class="form-row">
          <label>amount to decrypt (oct)</label>
          <input type="text" id="dec-amount" placeholder="0.000000">
        </div>
        <div class="form-row">
          <label>fee (ou) - recommended by default</label>
          <input type="text" id="dec-fee" placeholder="...">
        </div>
        <div class="action-row">
          <button class="action-btn" onclick="doDecrypt()">decrypt</button>
        </div>
        <div id="dec-result"></div>
      </div>
    </div>
  </div>

  <div class="view" id="view-stealth">
    <div class="balance-strip">
      <span class="bal-label">encrypted balance:</span> <span id="st-enc-bal-info" class="mono">-</span>
    </div>
    <div class="section-title">stealth send</div>
    <div class="form-area">
      <div class="form-row">
        <label>recipient address</label>
        <input type="text" id="stealth-to" placeholder="oct...">
      </div>
      <div class="form-row">
        <label>amount (oct)</label>
        <input type="text" id="stealth-amount" placeholder="0.000000">
      </div>
      <div class="form-row">
        <label>fee (ou) - recommended by default</label>
        <input type="text" id="stealth-fee" placeholder="...">
      </div>
      <div class="action-row">
        <button class="action-btn" onclick="doStealthSend()">stealth send</button>
      </div>
    </div>
    <div class="section-title">stealth outputs</div>
    <div class="action-row" style="padding:8px 10px">
      <button class="action-btn" onclick="doStealthScan()">scan</button>
    </div>
    <div class="stealth-outputs-area">
      <div id="stealth-outputs"><div class="staging-empty">no outputs scanned yet</div></div>
    </div>
  </div>

  <div class="view" id="view-tokens">
    <div class="balance-strip">
      <span class="bal-label">tokens:</span> <span id="tok-count" class="mono">-</span>
    </div>
    <div class="section-title">your tokens</div>
    <div id="tok-list"><div class="loading">loading tokens...</div></div>

    <div id="tok-transfer" style="display:none">
      <div class="section-title">transfer <span id="tok-transfer-sym"></span></div>
      <div class="form-area">
        <div class="form-row">
          <label>recipient</label>
          <input type="text" id="tok-to" placeholder="oct...">
        </div>
        <div class="form-row">
          <label>amount</label>
          <input type="text" id="tok-amount" placeholder="0">
        </div>
        <div class="form-row">
          <label>fee (ou) - recommended by default</label>
          <input type="text" id="tok-fee" placeholder="...">
        </div>
        <div class="action-row">
          <button class="action-btn" onclick="doTokenTransfer()">send</button>
          <button class="action-btn" style="background:#8C9DB6" onclick="closeTokenTransfer()">cancel</button>
        </div>
        <div id="tok-transfer-result"></div>
      </div>
    </div>

    <div class="section-title">token transactions</div>
    <div id="tok-txs"><div class="staging-empty">switch to a token to see transactions</div></div>
  </div>

  <div class="view" id="view-dev">
    <div class="balance-strip">
      <span class="bal-label">balance:</span> <span id="ct-bal" class="mono">-</span>
    </div>

    <div class="section-title">compile contract</div>
    <div class="form-area">
      <div class="form-row">
        <label>language</label>
        <select id="ct-lang" onchange="onLangChange()">
          <option value="aml" selected>AppliedML (.aml)</option>
          <option value="asm">Assembly (.oasm)</option>
        </select>
      </div>
      <div class="form-row">
        <label id="ct-source-label">AppliedML source (.aml)</label>
        <div class="editor-wrap">
          <div class="editor-gutter" id="ct-gutter">1</div>
          <div class="editor-body">
            <pre class="editor-highlight" id="ct-highlight"></pre>
            <textarea id="ct-source" class="code-editor" rows="14" oninput="editorUpdate()" onscroll="editorSync()" placeholder="contract Token {
  state { name: string, balances: map[address]int }
  constructor(n: string, supply: int) {
    self.name = n
    self.balances[origin] = supply
  }
  fn transfer(to: address, amt: int): bool {
    let bal = self.balances[caller]
    assert bal >= amt
    self.balances[caller] = bal - amt
    self.balances[to] = self.balances[to] + amt
    return true
  }
}" spellcheck="false"></textarea>
          </div>
        </div>
      </div>
      <div class="action-row">
        <button class="action-btn" onclick="doCompile()">compile</button>
      </div>
      <div id="ct-compile-result"></div>
      <div id="ct-abi-display" style="display:none">
        <div class="section-title" style="margin-top:8px">ABI</div>
        <pre id="ct-abi-json" class="code-editor" style="font-size:11px;max-height:200px;overflow:auto;padding:8px"></pre>
      </div>
    </div>

    <div class="section-title">deploy contract</div>
    <div class="form-area">
      <div class="form-row">
        <label>bytecode (base64, from compile)</label>
        <textarea id="ct-bytecode" rows="3" class="code-editor" placeholder="compiled bytecode..." spellcheck="false"></textarea>
      </div>
      <div class="form-row">
        <label>constructor params (json array, optional)</label>
        <input type="text" id="ct-deploy-params" placeholder='["MyToken", "MTK", 1000000]'>
      </div>
      <div class="form-row">
        <label>fee (ou) - recommended by default</label>
        <input type="text" id="ct-deploy-fee" placeholder="...">
      </div>
      <div class="action-row">
        <button class="action-btn" onclick="doPreviewDeploy()">preview address</button>
        <button class="action-btn" onclick="doDeploy()">deploy (50 oct)</button>
      </div>
      <div id="ct-deploy-result"></div>
    </div>

    <div class="section-title">call contract</div>
    <div class="form-area">
      <div class="form-row">
        <label>contract address</label>
        <input type="text" id="ct-call-addr" placeholder="oct...">
      </div>
      <div class="form-row">
        <label>method name</label>
        <input type="text" id="ct-call-method" placeholder="transfer">
      </div>
      <div class="form-row">
        <label>params (json array)</label>
        <input type="text" id="ct-call-params" placeholder='["oct...", 100]'>
      </div>
      <div class="form-row">
        <label>amount (oct, optional)</label>
        <input type="text" id="ct-call-amount" placeholder="0">
      </div>
      <div class="form-row">
        <label>fee (ou) - recommended by default</label>
        <input type="text" id="ct-call-fee" placeholder="...">
      </div>
      <div class="action-row">
        <button class="action-btn" onclick="doContractCall()">send call tx</button>
        <button class="action-btn" onclick="doContractView()">view (read-only)</button>
      </div>
      <div id="ct-call-result"></div>
    </div>

    <div class="section-title">contract info</div>
    <div class="form-area">
      <div class="form-row">
        <label>contract address</label>
        <input type="text" id="ct-info-addr" placeholder="oct...">
      </div>
      <div class="action-row">
        <button class="action-btn" onclick="doContractInfo()">lookup</button>
        <button class="action-btn" onclick="doContractReceipt()">last receipt</button>
      </div>
      <div id="ct-info-result"></div>
    </div>

    <div class="section-title">verify contract source</div>
    <div class="form-area">
      <div class="form-row">
        <label>contract address</label>
        <input type="text" id="ct-verify-addr" placeholder="oct...">
      </div>
      <div class="form-row">
        <label>AppliedML source (.aml)</label>
        <textarea id="ct-verify-source" class="code-editor" rows="8" placeholder="paste contract source code..." spellcheck="false"></textarea>
      </div>
      <div class="action-row">
        <button class="action-btn" onclick="doVerifyContract()">verify source</button>
      </div>
      <div id="ct-verify-result"></div>
    </div>
  </div>

  <div class="view" id="view-history">
    <div class="section-title">transaction history</div>
    <div id="history-list"><div class="loading">loading...</div></div>
    <div id="history-more"></div>
  </div>

  <div class="view" id="view-keys">
    <div class="section-title">wallet keys</div>
    <div class="keys-warn">private key is sensitive - do not share</div>
    <div id="keys-table"><div class="loading">loading...</div></div>
  </div>

  <div class="view" id="view-settings">
    <div class="section-title">node settings</div>
    <div class="form-area">
      <div class="form-row">
        <label>rpc url</label>
        <input type="text" id="settings-rpc" placeholder="http://165.227.225.79:8080">
      </div>
      <div class="form-row">
        <label>explorer url</label>
        <input type="text" id="settings-explorer" placeholder="https://devnet.octrascan.io">
      </div>
      <div class="action-row">
        <button class="action-btn" onclick="doSaveSettings()">save</button>
      </div>
      <div id="settings-result"></div>
    </div>
    <div class="section-title">change PIN</div>
    <div class="form-area">
      <div class="form-row">
        <label>current PIN</label>
        <input type="password" id="pin-current" maxlength="6" inputmode="numeric" placeholder="------" autocomplete="off">
      </div>
      <div class="form-row">
        <label>new PIN</label>
        <input type="password" id="pin-new" maxlength="6" inputmode="numeric" placeholder="------" autocomplete="off">
      </div>
      <div class="form-row">
        <label>confirm new PIN</label>
        <input type="password" id="pin-confirm-new" maxlength="6" inputmode="numeric" placeholder="------" autocomplete="off">
      </div>
      <div class="action-row">
        <button class="action-btn" onclick="doChangePin()">change PIN</button>
      </div>
      <div id="pin-change-result"></div>
    </div>
  </div>

  <div class="view" id="view-tx">
    <a href="#" class="back-link" onclick="goBack();return false">&larr; back</a>
    <div class="section-title">transaction</div>
    <div id="tx-detail"><div class="loading">loading...</div></div>
  </div>

</div>

<div class="footer">octra_wallet | 2026 | alpha ver. - 0.04.01</div>

</div>
<script src="wallet.js"></script>
</body>
</html>
